# 用于稀疏声场重建的物理引导扩散模型

## 中文版本

---

## 摘要

本文提出了一种物理引导的扩散模型（Physics-Guided Diffusion Model, PGDM），用于从稀疏传感器测量值重建二维声压场。传统的深度学习声场反演方法往往忽略波动方程约束，导致结果物理不一致。我们的方法将去噪扩散概率模型（DDPM）的生成能力与基于Helmholtz方程的物理约束相结合。具体而言，我们在损失函数中引入了三种物理约束：(1) Helmholtz残差最小化以强制满足波动方程，(2) 能量守恒以保持声功率平衡，(3) 边界条件强制以确保域边界处的适当场行为。

在多种障碍物配置的模拟声场上进行的大量实验表明，PGDM实现了优越的重建质量（PSNR > 27 dB，SSIM > 0.92，MAE < 0.05），同时保持了卓越的物理一致性（PDE残差 < 0.01）。与包括插值、等效源方法、普通U-Net和物理信息神经网络在内的基线方法相比，我们的方法将PSNR提高了2.2 dB，PDE残差降低了47%。该模型还通过随机采样过程提供不确定性量化，增强了在噪声控制、室内声学和医学超声成像等实际应用中的可解释性。

**关键词：** 声场重建，扩散模型，物理信息学习，逆问题，Helmholtz方程，深度学习

---

## 1. 引言

### 1.1 背景与动机

从稀疏测量值重建声场代表了计算声学中的一个基本逆问题，在多个领域具有深远的应用。在建筑声学中，准确的场重建能够优化吸声材料的布置以进行噪声控制[1]。医学超声成像依赖于从有限的换能器测量值重建组织声学特性[2]。水声学使用稀疏水听器阵列来绘制复杂的海洋声景图，用于导航和通信[3]。同样，室内声学需要从稀疏麦克风阵列获得密集的场信息，以表征混响和声音质量[4]。

固有的挑战在于该逆问题的不适定性：从有限数量的离散传感器测量值重建完整的高分辨率压力场。声场由Helmholtz方程控制，这是一个描述异质介质中波传播的偏微分方程。然而，对于稀疏观测，无穷多个场配置可能适配测量数据，使问题本质上欠定。

声场重建的传统方法可分为几个类别。**经典插值方法**如样条插值或克里金法提供平滑的场估计，但根本无法捕获衍射、干涉和散射等波现象[5]。**等效源方法（ESM）**使用靠近域边界放置的虚拟源来建模场，需要仔细的正则化和源位置策略[6, 7]。**边界元方法（BEM）**为特定几何形状提供精确解，但对于大规模问题计算成本高昂且需要完整的边界信息[8]。**压缩感知**方法利用变换域中的稀疏性从欠采样数据恢复场，但需要关于场结构的强先验假设[9, 10]。

深度学习的最新进展为声学逆问题开辟了新的可能性。卷积神经网络（CNN）在学习从稀疏观测到密集场的复杂映射方面表现出令人印象深刻的性能[11, 12]。物理信息神经网络（PINN）将偏微分方程残差纳入损失函数，提高了物理一致性[13, 14]。然而，这些纯数据驱动或混合方法面临重大限制：

1. **物理不一致性**：标准神经网络缺乏强制执行波动方程约束的固有机制，常常产生违反能量守恒和波传播原理等基本物理定律的场[15]。

2. **泛化能力差**：在特定频率范围或障碍物配置上训练的模型在遇到分布外场景时往往失败，限制了其实际适用性[16]。

3. **缺乏不确定性量化**：确定性神经网络提供点估计而没有置信度度量，使得在安全关键应用中难以评估重建可靠性[17]。

4. **可解释性有限**：黑盒深度学习模型对它们如何得出预测提供很少的见解，阻碍了科学理解和对结果的信任[18]。

### 1.2 扩散模型用于逆问题

去噪扩散概率模型（DDPM）最近作为一类强大的生成模型出现，在图像合成、音频生成和分子设计方面取得了最先进的性能[19, 20]。与变分自编码器（VAE）或生成对抗网络（GAN）不同，扩散模型学习通过迭代去噪步骤逆转逐渐加噪过程。这种方法提供了几个优势：稳定的训练动态、高质量的样本生成以及通过随机采样的自然不确定性量化[21]。

最近的工作开始探索扩散模型用于解决逆问题。Song等人[22]提出了基于分数的生成模型，学习数据分布的梯度，实现了各种逆问题的后验采样。Chung等人[23]开发了用于医学图像重建的扩散后验采样。Holzschuh等人[24]将扩散模型扩展到包含流体动力学问题的物理约束。然而，这些方法主要关注成像领域，没有充分解决声场重建的特定挑战，特别是波动方程约束的执行。

### 1.3 本文贡献

本工作弥合了物理信息学习和生成扩散模型在声场重建方面的差距。我们的主要贡献包括：

1. **物理引导扩散架构**：我们提出了一种新颖的条件扩散模型，通过多物理损失函数直接将Helmholtz方程约束整合到训练目标中。与简单将PDE残差作为正则化项添加的先前PINN不同，我们的方法从根本上塑造生成过程以尊重物理定律（图2）。

2. **综合物理约束**：我们设计了一个三组分物理损失，包含(i) Helmholtz残差用于波动方程满足，(ii) 能量守恒用于声功率平衡，(iii) 边界条件执行。消融研究表明每个组件都对重建质量和物理一致性有显著贡献（图7）。

3. **稀疏到密集重建**：我们的模型从少至30-80个稀疏观测（23-39%观测率）有效地重建完整的128×128声场，以显著优势超越现有方法。我们分析了不同的采样模式，包括随机、基于网格和线性阵列（图3）。

4. **不确定性量化**：利用扩散模型的随机性质，我们通过多次采样提供像素级不确定性估计。这使从业者能够识别模型具有高置信度的区域与需要额外测量的区域。

5. **广泛的实验验证**：我们在具有不同频率（500-2000 Hz）、障碍物几何形状（圆形、矩形、随机散射体）和观测密度的模拟声场上进行了全面的实验。结果表明在所有指标上都具有优越的性能（表1，图4-6）。

本文其余部分组织如下：第2节回顾物理信息学习和扩散模型的相关工作。第3节介绍我们的方法，包括问题表述、模型架构和物理约束损失设计。第4节描述实验设置和数据生成过程。第5节提供定量和定性结果以及消融研究。第6节讨论局限性、潜在应用和未来方向。第7节总结全文。

---

## 2. 相关工作

### 2.1 物理信息神经网络

Raissi等人[13]引入的物理信息神经网络（PINN）代表了科学机器学习的范式转变，通过将偏微分方程（PDE）残差直接纳入损失函数。关键见解是在训练期间将物理定律作为软约束执行，引导网络朝向物理上合理的解。自引入以来，PINN已成功应用于包括流体动力学[25]、传热[26]和电磁波传播[27]在内的各种问题。

一些扩展改进了原始PINN公式。自适应加权方案在训练期间动态平衡数据损失和物理损失[28]。多保真度PINN将低保真模拟与稀疏高保真数据相结合[29]。保守PINN通过专门的网络架构确保精确的守恒定律[30]。然而，大多数PINN变体侧重于正问题或参数估计，而不是从稀疏观测进行场重建的逆问题。

在声学中，PINN已被应用于波传播建模[31]和声场再现[32]。Chen等人[33]使用PINN进行声学超材料设计。Di等人[34]将物理信息学习应用于室内脉冲响应估计。虽然这些工作证明了物理约束的价值，但它们通常采用缺乏不确定性量化能力的确定性神经网络。

### 2.2 扩散模型和基于分数的生成模型

扩散模型已成为生成建模的领先方法，在样本质量方面与GAN竞争并经常超越GAN[19]。核心思想涉及定义一个前向扩散过程，逐渐用高斯噪声破坏数据，然后学习一个反向过程进行去噪。Ho等人[19]引入了具有简单去噪目标的DDPM。Song等人[20, 22]从连续时间角度开发了基于分数的生成模型，揭示了与随机微分方程的联系。

最近的工作将扩散模型扩展到条件生成和逆问题。用于图像超分辨率[35]、修复[36]和去模糊[37]的扩散模型表现出令人印象深刻的结果。Chung等人[23]提出了用于医学成像的扩散后验采样，使用测量一致性进行条件生成。Kawar等人[38]引入了用于噪声线性逆问题的SNIPS。

在科学计算中，扩散模型开始显示出潜力。Holzschuh等人[24]开发了用于湍流模拟的物理约束基于分数的模型。Lim等人[39]将扩散模型应用于天气预报。Shu等人[40]使用扩散进行PDE约束优化。然而，在声场重建中的应用仍然很大程度上未被探索。

### 2.3 声场重建

经典声场重建方法有着丰富的历史。**近场声全息（NAH）**使用平面或共形麦克风阵列向后传播声场到源表面[41, 42]。虽然NAH在理想条件下提供高精度，但它需要密集测量并对噪声敏感。

**等效源方法（ESM）**使用虚拟单极源分布来表示场[6, 7]。包括基本解方法[43]和波叠加[44]在内的变体已被开发。ESM需要仔细选择源位置和正则化参数，性能强烈依赖于这些选择。

**压缩感知**方法利用适当基（例如，平面波、球谐函数）中的稀疏性从随机测量重建场[9, 10, 45]。虽然理论上优雅，但压缩感知要求场在已知基中稀疏或可压缩，这对于复杂散射场景可能不成立。

**深度学习方法**用于声学重建正在兴起。Olivieri等人[46]使用CNN进行近场声全息。Fernandez-Grande等人[47]将深度学习应用于声场重建。Lee等人[48]开发了用于源定位的物理信息CNN。然而，这些方法通常缺乏严格的物理约束或不确定性量化。

我们的工作与现有方法的不同之处在于，将扩散模型的生成能力与显式物理约束相结合，在提供不确定性估计的同时实现高重建质量和物理一致性。

---

## 3. 方法论

### 3.1 问题表述

我们考虑在具有边界$\partial\Omega$的二维域$\Omega \subset \mathbb{R}^2$中的时谐声波传播。声压场$p: \Omega \rightarrow \mathbb{C}$满足Helmholtz方程：

$$
(\nabla^2 + k^2 n^2(\mathbf{x})) p(\mathbf{x}) = s(\mathbf{x}), \quad \mathbf{x} \in \Omega
$$
(1)

其中$\nabla^2 = \partial^2/\partial x^2 + \partial^2/\partial y^2$是Laplacian算子，$k = 2\pi f / c_0$是波数（频率$f$和参考声速$c_0$），$n(\mathbf{x}) \geq 1$是表征介质非均匀性的折射率场，$s(\mathbf{x})$代表声源。

折射率$n(\mathbf{x})$通过$n(\mathbf{x}) = c_0 / c(\mathbf{x})$与局部声速$c(\mathbf{x})$相关。在均匀介质中，$n(\mathbf{x}) = 1$。散射体和障碍物通过$n(\mathbf{x})$的空间变化来建模。

**逆问题**：给定在位置$\{\mathbf{x}_i\}_{i=1}^N \subset \Omega$处的稀疏压力测量$\{p(\mathbf{x}_i)\}_{i=1}^N$，其中$N \ll |\Omega|$，重建所有$\mathbf{x} \in \Omega$的完整压力场$p(\mathbf{x})$，使得：
- 重建场与观测匹配：$\hat{p}(\mathbf{x}_i) \approx p(\mathbf{x}_i)$，$i = 1, \ldots, N$
- 场满足Helmholtz方程(1)
- 物理约束（能量守恒、边界条件）得到尊重

由于观测系统的欠定性质，该问题严重不适定。通过物理约束进行额外正则化对于获得有意义的解至关重要。

### 3.2 物理引导扩散模型

#### 3.2.1 表示

我们使用复压力场$p(\mathbf{x}) = p_r(\mathbf{x}) + i \cdot p_i(\mathbf{x})$的实部和虚部分量来表示，在$H \times W$网格上离散化为张量$\mathbf{p} \in \mathbb{R}^{2 \times H \times W}$，其中第一个通道包含$p_r$，第二个包含$p_i$。类似地，稀疏观测表示为$\mathbf{p}_{sparse} \in \mathbb{R}^{2 \times H \times W}$，仅在测量位置具有非零值。

#### 3.2.2 前向扩散过程

遵循DDPM [19]，我们定义一个前向马尔可夫链，在$T$个时间步上逐渐向数据添加高斯噪声：

$$
q(\mathbf{x}_t | \mathbf{x}_{t-1}) = \mathcal{N}(\mathbf{x}_t; \sqrt{1-\beta_t} \mathbf{x}_{t-1}, \beta_t \mathbf{I})
$$
(2)

其中$\{\beta_t\}_{t=1}^T$是方差调度，$\beta_t \in (0, 1)$。时间步$t$处的边际分布具有闭式形式：

$$
q(\mathbf{x}_t | \mathbf{x}_0) = \mathcal{N}(\mathbf{x}_t; \sqrt{\bar{\alpha}_t} \mathbf{x}_0, (1-\bar{\alpha}_t) \mathbf{I})
$$
(3)

其中$\alpha_t = 1 - \beta_t$和$\bar{\alpha}_t = \prod_{i=1}^t \alpha_i$。我们在1000步上使用$\beta_1 = 10^{-4}$和$\beta_T = 0.02$的线性调度。

#### 3.2.3 反向去噪过程

反向过程学习逐渐去噪：

$$
p_\theta(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{c}) = \mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t, \mathbf{c}), \boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t))
$$
(4)

其中$\mathbf{c} = \mathbf{p}_{sparse}$表示稀疏观测条件。实践中，我们参数化噪声预测网络$\boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t, \mathbf{c})$并计算均值为：

$$
\boldsymbol{\mu}_\theta(\mathbf{x}_t, t, \mathbf{c}) = \frac{1}{\sqrt{\alpha_t}} \left( \mathbf{x}_t - \frac{1-\alpha_t}{\sqrt{1-\bar{\alpha}_t}} \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t, \mathbf{c}) \right)
$$
(5)

我们按照[19]固定方差为$\boldsymbol{\Sigma}_\theta = \beta_t \mathbf{I}$。

#### 3.2.4 U-Net架构

我们的噪声预测网络$\boldsymbol{\epsilon}_\theta$采用条件U-Net架构（图2），包括：

**编码器路径**：四个下采样块，通道维度为$\{64, 128, 256, 512\}$。每个块包含两个带有组归一化和SiLU激活的残差块。

**中间块**：三个残差块，在$16 \times 16$分辨率处进行自注意力以捕获长程依赖关系。

**解码器路径**：四个上采样块，从编码器具有对称跳跃连接。每个块处理来自编码器和当前解码器层的级联特征。

**条件化**：稀疏观测$\mathbf{c}$通过卷积层嵌入并添加到输入特征。时间嵌入$t$使用投影到256维的正弦位置编码，并通过自适应组归一化注入到每个残差块中。

完整网络包含约5900万个可训练参数。

### 3.3 物理约束损失函数

我们的训练目标结合了扩散损失和三个基于物理的约束：

$$
\mathcal{L}_{total} = \mathcal{L}_{diff} + \lambda_1 \mathcal{L}_{helm} + \lambda_2 \mathcal{L}_{energy} + \lambda_3 \mathcal{L}_{bound}
$$
(6)

其中$\lambda_1, \lambda_2, \lambda_3$是平衡不同项的超参数。

#### 3.3.1 扩散损失

标准DDPM目标：

$$
\mathcal{L}_{diff} = \mathbb{E}_{t, \mathbf{x}_0, \boldsymbol{\epsilon}} \left[ \| \boldsymbol{\epsilon} - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t, \mathbf{c}) \|^2 \right]
$$
(7)

其中$\boldsymbol{\epsilon} \sim \mathcal{N}(0, \mathbf{I})$和$t \sim \text{Uniform}(1, T)$。

#### 3.3.2 Helmholtz残差损失

为了强制波动方程满足，我们在预测的干净样本$\hat{\mathbf{x}}_0$上计算Helmholtz残差：

$$
\mathcal{L}_{helm} = \| \nabla^2 \hat{\mathbf{p}} + k^2 n^2 \hat{\mathbf{p}} - \mathbf{s} \|^2
$$
(8)

Laplacian $\nabla^2$使用五点有限差分模板近似：

$$
(\nabla^2 \hat{\mathbf{p}})_{i,j} \approx \frac{\hat{\mathbf{p}}_{i+1,j} + \hat{\mathbf{p}}_{i-1,j} + \hat{\mathbf{p}}_{i,j+1} + \hat{\mathbf{p}}_{i,j-1} - 4\hat{\mathbf{p}}_{i,j}}{\Delta x^2}
$$
(9)

其中$\Delta x$是网格间距。对于复数场，此操作独立应用于实部和虚部分量。

#### 3.3.3 能量守恒损失

声能应该守恒（除了边界损失）。我们强制执行：

$$
\mathcal{L}_{energy} = \left| \int_\Omega |\hat{\mathbf{p}}|^2 d\mathbf{x} - \int_\Omega |\mathbf{p}|^2 d\mathbf{x} \right|
$$
(10)

离散形式：

$$
\mathcal{L}_{energy} = \left| \sum_{i,j} (|\hat{\mathbf{p}}_{i,j}|^2 - |\mathbf{p}_{i,j}|^2) \right| / \sum_{i,j} |\mathbf{p}_{i,j}|^2
$$
(11)

#### 3.3.4 边界条件损失

对于吸收边界，我们惩罚大的法向导数：

$$
\mathcal{L}_{bound} = \| \nabla \hat{\mathbf{p}} \cdot \mathbf{n} |_{\partial\Omega} \|^2
$$
(12)

其中$\mathbf{n}$是外法向。我们通过惩罚边界像素与其直接邻居之间的差异来近似这一点。

### 3.4 训练和推理

**训练**：我们使用AdamW优化器[49]，学习率$\eta = 10^{-4}$，权重衰减$10^{-5}$和余弦退火调度。批量大小为8，训练100个epoch。基于验证性能，物理损失权重为$\lambda_1 = 1.0$，$\lambda_2 = 0.5$，$\lambda_3 = 0.3$。在NVIDIA RTX 3090 GPU上训练大约需要12小时。

**推理**：给定稀疏观测$\mathbf{c}$，我们从后验采样：
1. 初始化$\mathbf{x}_T \sim \mathcal{N}(0, \mathbf{I})$
2. 对于$t = T, T-1, \ldots, 1$：
   - 预测噪声：$\boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t, \mathbf{c})$
   - 计算均值：通过方程(5)计算$\boldsymbol{\mu}_\theta$
   - 采样：$\mathbf{x}_{t-1} \sim \mathcal{N}(\boldsymbol{\mu}_\theta, \beta_t \mathbf{I})$
3. 返回$\mathbf{x}_0$作为重建场

对于不确定性量化，我们运行多个独立采样链并计算经验均值和标准差。

---

## 4. 实验设置

### 4.1 数据生成

我们使用基于有限差分法的Helmholtz方程求解器生成合成声场数据（图1）。对于每个样本：

**域**：在$128 \times 128$网格上离散化的$\Omega = [0, 1]^2$，间距$\Delta x = 1/128$。

**频率**：从$\{500, 1000, 1500, 2000\}$ Hz随机选择，参考声速$c_0 = 343$ m/s，给出波数$k \in \{9.16, 18.32, 27.48, 36.64\}$ rad/m。

**折射率**：三种障碍物类型（图1）：
- **圆形**：随机位置的圆形散射体，半径$r \in [0.05L, 0.15L]$，$n \in [1.2, 1.8]$
- **方形**：矩形障碍物，边长$\ell \in [0.1L, 0.2L]$，$n \in [1.2, 1.8]$
- **随机**：2-4个随机放置的圆形散射体，大小和折射率不同

**源**：$(x, y) = (0.1L, 0.5L)$处的点源或宽度$\sigma = 0.05L$的高斯源。

**Helmholtz求解器**：我们使用五点模板离散化方程(1)，形成稀疏线性系统$\mathbf{A}\mathbf{p} = \mathbf{s}$，通过稀疏直接求解器(SuperLU)或迭代GMRES（容差$10^{-6}$）求解。

**稀疏采样**：三种模式（图3）：
- **随机**：$N \in [30, 80]$个均匀随机位置
- **网格**：规则$\sqrt{N} \times \sqrt{N}$网格
- **线性**：$x = 0.25L$处的垂直阵列

**数据集统计**：总共1000个样本，分为80%训练集(800)和20%验证集(200)。每个样本存储为压缩的`.npz`文件，包含真值场、稀疏观测、折射率、源和元数据。

### 4.2 基线方法

我们与以下方法进行比较：

1. **插值**：使用高斯核的径向基函数(RBF)插值
2. **ESM**：带Tikhonov正则化的等效源方法($\alpha = 10^{-3}$)
3. **U-Net**：没有物理约束的普通条件U-Net
4. **PINN**：仅带Helmholtz残差损失的物理信息神经网络

所有基线使用相同的训练数据和评估协议。

### 4.3 评估指标

**重建质量**：
- **平均绝对误差(MAE)**：$\frac{1}{|\Omega|} \sum_{\mathbf{x} \in \Omega} |\hat{p}(\mathbf{x}) - p(\mathbf{x})|$
- **峰值信噪比(PSNR)**：$20 \log_{10}(\max|p| / \sqrt{MSE})$
- **结构相似性指数(SSIM)**：测量感知相似性

**物理一致性**：
- **PDE残差**：$\frac{1}{|\Omega|} \| \nabla^2 \hat{p} + k^2 n^2 \hat{p} - s \|^2$
- **能量误差**：$|\int |\hat{p}|^2 - \int |p|^2| / \int |p|^2$

---

## 5. 结果与分析

### 5.1 定量比较

表1展示了我们的PGDM与基线方法的定量结果。我们的方法在所有指标上都获得了最佳性能：

**重建质量**：PGDM获得MAE为0.042，PSNR为27.3 dB，SSIM为0.92，在MAE上比第二好的方法(PINN)提高21%，PSNR提高2.2 dB。与普通U-Net相比的改进（MAE降低37%，PSNR增加3.5 dB）证明了物理约束的价值。经典方法（插值、ESM）表现明显更差，证实了学习方法的优势。

**物理一致性**：PGDM的PDE残差为0.008，比PINN(0.015)低47%，比U-Net(0.028)低71%，表明更好地遵守波动方程约束。这证明我们的三组分物理损失（Helmholtz + 能量 + 边界）比仅Helmholtz残差提供了更强的正则化。

图4展示了定性重建结果。PGDM准确捕获波干涉模式、障碍物周围的衍射和场幅度分布。误差图显示重建误差主要集中在场梯度最大的障碍物边界附近。

### 5.2 消融研究

为了分析每个物理约束的贡献，我们训练了具有不同损失组合的模型变体（图7）：

1. **仅扩散**($\lambda_1 = \lambda_2 = \lambda_3 = 0$)：PSNR = 24.1 dB，PDE残差 = 0.028
2. **+ Helmholtz**($\lambda_1 = 1.0$)：PSNR = 26.2 dB，PDE残差 = 0.012
3. **+ 能量**($\lambda_1 = 1.0, \lambda_2 = 0.5$)：PSNR = 26.8 dB，PDE残差 = 0.010
4. **+ 边界(完整)**($\lambda_1 = 1.0, \lambda_2 = 0.5, \lambda_3 = 0.3$)：PSNR = 27.3 dB，PDE残差 = 0.008

每个额外的约束都改善了重建质量和物理一致性。Helmholtz项提供了最大的增益（+2.1 dB PSNR，-57%残差），证实了其对强制执行波传播物理的重要性。能量守恒增加+0.6 dB，边界条件贡献+0.5 dB，收益递减但有意义。

### 5.3 物理约束可视化

图5可视化了物理约束：

(a) **Helmholtz残差图**：显示PDE违反的空间分布。残差集中在障碍物边界和源位置附近，幅度通常< 0.1。

(b) **能量分布**：显示声强$|p|^2$。模型准确再现高压区域的能量集中和干涉零点。

(c) **残差统计**：残差幅度的直方图遵循长尾分布，均值为0.008，证实平均误差低且偶尔有局部违反。

### 5.4 训练动态

图6显示了训练曲线：

(a) **训练损失**：在100个epoch内从2.0指数下降到0.3，表明稳定优化。

(b) **验证MAE**：从0.15改善到0.04，初期进展快速（epoch 1-30），之后缓慢改进。

(c) **验证PSNR**：从15增加到27 dB，在epoch 80左右饱和，表明收敛。

平滑的曲线没有振荡，证明了物理约束训练的稳定性。

### 5.5 泛化分析

为了测试泛化，我们评估：

**未见频率**：在750、1250、1750 Hz（不在训练集中）上测试产生PSNR = 26.1 dB和MAE = 0.048，仅比分布内性能差4.4%。这表明合理的频率插值能力。

**不同稀疏度**：随着观测减少，性能优雅降级：80点(PSNR = 28.1 dB)，50点(27.3 dB)，30点(25.8 dB)，20点(23.9 dB)。即使只有15%的观测率，模型仍然可用。

**不同障碍物**：在未见障碍物配置上的交叉验证显示最小的性能下降(<3%)，表明良好的几何泛化。

### 5.6 不确定性量化

通过运行10次独立采样，我们获得不确定性估计。高不确定性区域（大标准差）与以下相关：
- 远离观测点的区域
- 具有复杂散射的障碍物附近区域
- 低信噪比区域

这种不确定性量化帮助从业者识别额外测量最有价值的位置。

---

## 6. 讨论

### 6.1 优势

**物理一致性**：三组分物理损失确保重建满足基本声学原理，对科学有效性和实际可靠性至关重要。

**不确定性量化**：与确定性方法不同，扩散模型自然提供置信度估计，实现风险感知决策。

**灵活性**：条件化机制处理可变数量和位置的观测而无需重新训练。

**泛化**：在未见频率和几何形状上的合理性能表明比训练分布更广泛的适用性。

### 6.2 局限性

**计算成本**：扩散采样需要$T = 1000$个迭代去噪步骤，在CPU上每个128×128场需要约5秒。未来工作可以探索蒸馏或DDIM采样[50]以加速。

**2D约束**：当前实现专注于2D场。扩展到3D需要显著的内存优化，但在架构上很简单。

**频率范围**：对于非常高的频率($f > 3$ kHz，$k > 55$)，由于网格分辨率不足，性能下降。自适应网格细化可以解决这个问题。

**模拟数据**：虽然我们的Helmholtz求解器生成逼真的场，但实际测量涉及噪声、校准误差和模型失配。使用有限实际数据的迁移学习是重要的未来方向。

### 6.3 应用

**室内声学**：从稀疏麦克风阵列重建3D声场，用于声学质量评估和虚拟现实。

**噪声控制**：基于重建的高分辨率场识别吸声的最佳位置。

**医学超声**：从有限换能器测量改善组织表征，进行不确定性感知诊断。

**水声学**：使用稀疏水听器网络绘制海洋声景图，用于海洋生物学和海军应用。

### 6.4 未来工作

- **实际数据验证**：与实验声学家合作测试物理测量
- **3D扩展**：使用内存高效架构进行体积重建
- **多模态融合**：结合声学测量与视觉或热数据
- **主动学习**：由不确定性量化引导的最优传感器布置
- **更快采样**：知识蒸馏或一致性模型用于实时推理
- **更广泛的物理**：扩展到时域、非线性声学或耦合物理

---

## 7. 结论

我们提出了一种用于稀疏声场重建的物理引导扩散模型，成功地统一了扩散模型的生成能力与来自Helmholtz方程的严格物理约束。我们的综合物理损失函数，包含波动方程残差、能量守恒和边界条件，确保了高重建保真度和物理一致性。

大量实验表明，相对于现有方法的优越性能，在模拟声场上实现27.3 dB PSNR、0.92 SSIM和0.008 PDE残差。消融研究证实每个物理约束都对整体性能有意义地贡献。该模型对未见频率和几何形状表现出强大的泛化能力，同时通过随机采样提供有价值的不确定性量化。

这项工作展示了物理信息生成模型在声学之外的逆问题中的潜力，为计算物理、医学成像和环境监测中的应用开辟了途径。通过桥接机器学习和物理建模，我们实现了对具有实际影响的挑战性逆问题的数据高效、物理一致的解决方案。

---

## 参考文献

[同英文版，此处省略]

---

## 附录

**附录A：网络架构详细信息**

具有58,978,242参数的完整U-Net规格：
- 输入通道：2（实部+虚部）
- 基础通道：64
- 通道乘数：[1, 2, 4, 8] → [64, 128, 256, 512]
- 每层残差块：2
- 注意力分辨率：[16×16]
- 时间嵌入：256维正弦 + MLP
- 条件嵌入：64维卷积

**附录B：超参数选择**

物理损失权重通过验证集上的网格搜索选择：
- $\lambda_1 \in \{0.5, 1.0, 2.0\}$：最佳值1.0
- $\lambda_2 \in \{0.1, 0.5, 1.0\}$：最佳值0.5
- $\lambda_3 \in \{0.1, 0.3, 0.5\}$：最佳值0.3

学习率调度：在100个epoch内从$10^{-4}$到$10^{-6}$的余弦退火。

**附录C：计算要求**

训练：在NVIDIA RTX 3090 (24GB VRAM)上12小时，批量大小8
推理：CPU上每样本5秒，GPU上0.3秒
内存：训练期间峰值8GB，推理期间2GB
